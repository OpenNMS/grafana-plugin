{"version":3,"sources":["../../../../../src/datasources/fault-ds/ui/Filter.js"],"names":["Filter","uiSegmentSrv","query","Query","root","updateControls","string","isEmpty","queryString","asString","length","clear","clause","Clause","uiClause","ClauseMapping","getUiClause","addClause","Error","removeClause"],"mappings":";;;;;;;;;AAAA;;;;AACA;;AACA;;AACA;;;;;;IAEaA,M,WAAAA,M;AACT,oBAAYC,YAAZ,EAA0B;AAAA;;AACtB,aAAKA,YAAL,GAAoBA,YAApB;AACA,aAAKC,KAAL,GAAa,IAAI,OAAGC,KAAP,CAAaF,YAAb,CAAb;AACA,aAAKC,KAAL,CAAWE,IAAX,GAAkB,IAAlB;AACH;;;;yCAEgB;AACb,iBAAKF,KAAL,CAAWG,cAAX;AACH;;;yCAEgB;AACb,gBAAIC,SAAS,mBAAb;AACA,gBAAI,KAAKJ,KAAL,CAAWK,OAAX,EAAJ,EAA0B;AACtB,uBAAOD,MAAP;AACH;;AAED,gBAAIE,cAAc,KAAKN,KAAL,CAAWO,QAAX,EAAlB;AACA,gBAAID,eAAeA,YAAYE,MAAZ,GAAqB,CAAxC,EAA2C;AACvC,uBAAOJ,SAAS,SAAT,GAAqBE,WAA5B;AACH;AACD,mBAAOF,MAAP;AACH;;;gCAEO;AACJ,iBAAKJ,KAAL,CAAWS,KAAX;AACH;;;kCAESC,M,EAAQ;AACd,gBAAIA,kBAAkB,aAAIC,MAA1B,EAAkC;AAC9B,oBAAMC,WAAW,IAAI,iBAAQC,aAAZ,CAA0B,KAAKd,YAA/B,EAA6Ce,WAA7C,CAAyDJ,MAAzD,CAAjB;AACA,qBAAKV,KAAL,CAAWe,SAAX,CAAqBH,QAArB;AACH,aAHD,MAGO,IAAIF,kBAAkB,OAAGC,MAAzB,EAAiC;AACpC,qBAAKX,KAAL,CAAWe,SAAX,CAAqBL,MAArB;AACH,aAFM,MAEA;AACH,sBAAM,IAAIM,KAAJ,CAAU,8BAAV,CAAN;AACH;AACJ;;;mCAEUN,M,EAAQ;AACf,iBAAKK,SAAL,CAAeL,MAAf;AACA,mBAAO,IAAP;AACH;;;qCAEYA,M,EAAQ;AACjB,iBAAKV,KAAL,CAAWiB,YAAX,CAAwBP,MAAxB;AACH","file":"Filter.js","sourcesContent":["import _ from 'lodash';\nimport {API} from '../../../opennms';\nimport {Mapping} from '../Mapping';\nimport {UI} from '../UI';\n\nexport class Filter {\n    constructor(uiSegmentSrv) {\n        this.uiSegmentSrv = uiSegmentSrv;\n        this.query = new UI.Query(uiSegmentSrv);\n        this.query.root = true;\n    }\n\n    updateControls() {\n        this.query.updateControls();\n    }\n\n    getQueryString() {\n        let string = \"select all alarms\";\n        if (this.query.isEmpty()) {\n            return string;\n        }\n\n        let queryString = this.query.asString();\n        if (queryString && queryString.length > 0) {\n            return string + \" where \" + queryString;\n        }\n        return string;\n    }\n\n    clear() {\n        this.query.clear();\n    }\n\n    addClause(clause) {\n        if (clause instanceof API.Clause) {\n            const uiClause = new Mapping.ClauseMapping(this.uiSegmentSrv).getUiClause(clause);\n            this.query.addClause(uiClause);\n        } else if (clause instanceof UI.Clause) {\n            this.query.addClause(clause);\n        } else {\n            throw new Error(\"Clause type is not supported\");\n        }\n    }\n\n    withClause(clause) {\n        this.addClause(clause);\n        return this;\n    }\n\n    removeClause(clause) {\n        this.query.removeClause(clause);\n    }\n}"]}